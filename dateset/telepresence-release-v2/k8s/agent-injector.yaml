---
apiVersion: v1
kind: Service
metadata:
  name: agent-injector
  namespace: ambassador
spec:
  type: ClusterIP
  selector:
    app: traffic-manager
    telepresence: manager
  ports:
    - name: agent-injector
      port: 443
      targetPort: https
---
apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: agent-injector-webhook
webhooks:
  - name: agent-injector.getambassador.io
    clientConfig:
      service:
        name: agent-injector
        namespace: ambassador
        path: "/traffic-agent"
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZGVENDQXYyZ0F3SUJBZ0lFRHY3S3NEQU5CZ2txaGtpRzl3MEJBUXNGQURBYk1Sa3dGd1lEVlFRS0V4Qm4KWlhSaGJXSmhjM05oWkc5eUxtbHZNQjRYRFRJeE1EWXdPVEEyTVRnd09Wb1hEVEl5TURZd09UQTJNVGd3T1ZvdwpHekVaTUJjR0ExVUVDaE1RWjJWMFlXMWlZWE56WVdSdmNpNXBiekNDQWlJd0RRWUpLb1pJaHZjTkFRRUJCUUFECmdnSVBBRENDQWdvQ2dnSUJBTjdrbzROZHMvZTdvaVU0WGM1Rm5DcUlTNDNnZ01Zd2MrR1huaW9zQk50R000K00KMEFiODgweUx2WlRQTURoSVJQbmtlSm9UeThhN3NETVRQcHdtc2tmZFNJRjNRQlVKSlc3ZGNpaWI3Y3lmTzdUWgp2UmM0YW5SSXpYYUtsc1pRQ3ZZNUVLOHJOZ3hDYmd3VGprdldoN01iOUpPdFZqcDMyTEhaUFV5Q1RKQ1diUzRjCm05MHZiWVFOclNPZUpLc0I3bEUrWGVrWnEvODI4OXpBWXBpakYxY3Z3aW1sMU83eUMyc2hKa1Urd0lUcldVSmYKd1J5SDZMVk5zSlZKaXZjWU1EN01panU0T0tPOG1lZkUrYlYxRXpjYVpmWmh4OGowZWNMZjRPdUhQUlBMS2pyVQpjUFFheFRZZm9hdlpKV0RyQU5VSnNEb01BWUZyZkh4VFlmZHZFY2RHaGN0Z1Rpb2xPbUpkenMzYWpwVWpINnhICllOTWRsb2YreHpGSlQzbWxYZ2pKMHJXc2NwQ0lkSG1vVXFWQURpR0huSTJzVEpFMkpneFBodzRYcGQ1OHRxOFQKTFBBZGdsdDF6R2VHeGl5Z3BuU0UyaGppY2grcm1DUlcrT1BReCtMQTdIQTFlTitWZmxpWTJ4S1pDaXlydmdHNApjamlPb2lsR05iOXI5M1ZqT0MrUnpVUWlwRklLVnBqVFc5V1BvQVRTajc3aUJWbmxVWSs3SHpmN2VnS0RNVTBPCjNGRFJOS0Zra1IwTmN1T2dZQTZ3ZmMwbUhJaFpucThVd0pPMTdiRGcrYm5nYUF4RmdJT0Z0ZnJ2U0IybUpXZTEKTkdoSWpkdWt6VkxkbmxjOThDQXhyZHQxbnRlU3hOYnlFTWJvZkxRNTBRUHNHM3htWk5peUMzcFJtV3ZaQWdNQgpBQUdqWVRCZk1BNEdBMVVkRHdFQi93UUVBd0lDaERBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjREFnWUlLd1lCCkJRVUhBd0V3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFkQmdOVkhRNEVGZ1FVeEplTitoYjJJdThFYWN6K2FNZVcKUHNiemhZUXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnSUJBTGZESlNxSFZlQ083cWlsaGJ2REhabjBhaW01RTMvMgpyT0FScVE1MFJPZ1hKQy9DM3RrK0Q5NG5JelI1azlMNHBNQ2xSR3prZWQ4bmltRExJMUVPa1hka3czQ0xucXBSCmppam5DV3hOczJIQS9RTGxGNHJZREJXRVk2OFF2OWo3MmFQT1plbTE1d1RXeGswSkd0c05JQ1FkQ08wcjRCWDQKdTAzUFcxVFVnRTBCZS9zNFBuRVM4TVAwdFRacmRxNVk3UDh4c1FxOGEzYjhaR3FYbmdmY3AvOHArVjBQcWhVdQpKdEpoeDhQcjNSMXZDNEFXc1lzTWlQNHZuV3gxVWkrVDUybllGZTNnVHFyc2NPYU9vVUhiOGh0VnI4NGZFOWxRClBIQ2NGTmdQdERPSTBzREgrSmdKQS9Ec3N5MHRZQ2VacGNwUTcybkxPVU5IZzdaUktOa01tVTdua1BmMStBb1cKZTFNY1kycW96dCtwRmZjdGg2d2YzYTNDZEU2ZGtqM1BFd0xrelBxL2lVZTFEbDk4anBYTjJvNGdDcThDS0t1QQo3dFYzekhJZFhwYW53UFVQVEFJQUovSDFPempIZ2ptNUo1NDdBY3dlbUQ4UkFCRTkrSGREYVJtaitCeXd4MFQxCmRDRVNyNm90WThFUVhETGtSQ1hqdnRIM2lORXhHOW9IbjZxL1lZcmtNc2kzNldwSkhpN2lGUmRwMEhXbDBLMmsKeWZFelNRUjR4TE5OWk0zaVBpYXQvZzAyaEEzTGVjbllzU3BMS1RmSFd2T3VTT3kwK1lrR1VsWXQ4Wlgyc2I5cgo5d0dGeFFTQmFrRzNSNkdTMjF2azFCdkpJd2hlcjlBRVowdWtCS282ZS9IcEN4MFFPd2dlempkV1pkUzVvWmdLCmYxczRZaE5PVUVMWAotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    rules:
      - operations: ["CREATE"]
        apiGroups: [""]
        apiVersions: ["v1"]
        resources: ["pods"]
    sideEffects: None
    admissionReviewVersions: ["v1"]
    timeoutSeconds: 5
