#   Copyright The containerd Authors.

#   Licensed under the Apache License, Version 2.0 (the "License");
#   you may not use this file except in compliance with the License.
#   You may obtain a copy of the License at

#       http://www.apache.org/licenses/LICENSE-2.0

#   Unless required by applicable law or agreed to in writing, software
#   distributed under the License is distributed on an "AS IS" BASIS,
#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#   See the License for the specific language governing permissions and
#   limitations under the License.

# -----------------------------------------------------------------------------
# From https://github.com/containerd/nerdctl/blob/v0.12.1/.golangci.yml
# -----------------------------------------------------------------------------
---
run:
  concurrency: 6
linters:
  disable-all: true
  enable:
  # - depguard # annoying since golangci-lint v1.53.1 https://github.com/golangci/golangci-lint/issues/3877
  - gofmt
  - goimports
  - govet
  - ineffassign
  - misspell
  - nakedret
  # - prealloc
  - typecheck
  # - asciicheck
  - bodyclose
  # - dogsled
  # - dupl
  - dupword
  - errcheck
  - errorlint
  # - exhaustive
  # - exhaustivestruct
  # - exportloopref
  # - funlen
  # - gci
  # - gochecknoglobals
  # - gochecknoinits
  # - gocognit
  # - goconst
  - gocritic
  # - gocyclo
  # - godot
  # - godox
  # - goerr113
  - gofumpt
  # - goheader
  # - golint
  # - gomnd
  # - gomodguard
  # - goprintffuncname
  # - gosec (gas)
  - gosimple
  # - interfacer
  # - lll
  # - maligned
  # - nestif
  # - nlreturn
  - noctx
  - nolintlint
  # - rowserrcheck
  # - scopelint
  # - sqlclosecheck
  - staticcheck
  # - stylecheck
  # - testpackage
  # - tparallel
  - revive
  # - unconvert
  # - unparam
  - unused
  - whitespace
  # - wrapcheck
  # - wsl
linters-settings:
  gocritic:
    # See "Tags" section in https://github.com/go-critic/go-critic#usage
    enabled-tags:
    - diagnostic
    - performance
    - style
    - opinionated
    - experimental
    disabled-checks:
    - appendCombine
    - sloppyReassign
    - unlabelStmt
    - rangeValCopy
    - hugeParam
    - importShadow
    - ifElseChain
    - sprintfQuotedString
    - builtinShadow
    - filepathJoin
  errorlint:
    asserts: false
issues:
  # Maximum issues count per one linter.
  max-issues-per-linter: 0
  # Maximum count of issues with the same text.
  max-same-issues: 0
  exclude-rules:
  # Allow using Uid, Gid in pkg/osutil.
  - path: "pkg/osutil/"
    text: "uid"
