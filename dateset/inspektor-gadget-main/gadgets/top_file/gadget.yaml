name: top file
description: Periodically report read/write activity by file
homepageURL: https://inspektor-gadget.io/
documentationURL: https://inspektor-gadget.io/docs
sourceURL: https://github.com/inspektor-gadget/inspektor-gadget/
toppers:
  file:
    mapName: stats
    structName: file_stat
structs:
  file_stat:
    fields:
    - name: pid
      description: Process ID
      attributes:
        template: pid
    - name: tid
      description: Thread ID
      attributes:
        hidden: true
        template: pid
    - name: comm
      description: Command name
      attributes:
        template: comm
    - name: reads
      description: Reads by file
      attributes:
        width: 8
    - name: writes
      description: Writes by file
      attributes:
        width: 8
    - name: rbytes
      description: Bytes read by file
      attributes:
        width: 8
    - name: wbytes
      description: Bytes written by file
      attributes:
        width: 8
    - name: t
      description: Type of file, 'R' for regular files, 'S' for sockets and 'O' for
        others (including pipes). By default only regular files are shown; use the
        --all-files option to show all file types.
      attributes:
        width: 1
    - name: file
      description: File name
      attributes:
        width: 30
    - name: mntns_id
      description: Mount namespace ID
      attributes:
        template: ns
ebpfParams:
  all_files:
    key: all-files
    defaultValue: "false"
    description: Trace all files types. By default, only regular files are traced
  target_pid:
    key: pid
    defaultValue: "0"
    description: Show only events generated by process with this PID
